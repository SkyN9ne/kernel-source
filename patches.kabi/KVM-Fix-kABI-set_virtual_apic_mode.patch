From: Juergen Gross <jgross@suse.com>
Date: Mon, 15 Feb 2021 08:25:00 +0100
Subject: [PATCH] KVM: Fix kABI for tlb_flush
Patch-mainline: never, kABI workaround
References: bsc#1182310

Signed-off-by: Juergen Gross <jgross@suse.com>
---
 arch/x86/include/asm/kvm_host.h | 4 ++++
 1 file changed, 4 insertions(+)

--- a/arch/x86/include/asm/kvm_host.h
+++ b/arch/x86/include/asm/kvm_host.h
@@ -1042,7 +1042,11 @@ struct kvm_x86_ops {
 	void (*hwapic_irr_update)(struct kvm_vcpu *vcpu, int max_irr);
 	void (*hwapic_isr_update)(struct kvm_vcpu *vcpu, int isr);
 	void (*load_eoi_exitmap)(struct kvm_vcpu *vcpu, u64 *eoi_exit_bitmap);
+#ifndef __GENKSYMS__
 	void (*set_virtual_apic_mode)(struct kvm_vcpu *vcpu);
+#else
+	void (*set_virtual_x2apic_mode)(struct kvm_vcpu *vcpu, bool set);
+#endif
 	void (*set_apic_access_page_addr)(struct kvm_vcpu *vcpu, hpa_t hpa);
 	void (*deliver_posted_interrupt)(struct kvm_vcpu *vcpu, int vector);
 	int (*sync_pir_to_irr)(struct kvm_vcpu *vcpu);
