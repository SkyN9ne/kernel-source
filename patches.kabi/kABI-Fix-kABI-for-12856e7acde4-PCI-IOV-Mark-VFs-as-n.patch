From: Joerg Roedel <jroedel@suse.de>
Date: Wed, 30 Sep 2020 11:03:01 +0200
Subject: [PATCH] kABI: Fix kABI for 12856e7acde4 PCI/IOV: Mark VFs as not
 implementing PCI_COMMAND_MEMORY
Patch-mainline: Never, SLE specific kABI Fix
References: bsc#1176979

Signed-off-by: Joerg Roedel <jroedel@suse.de>
---
 include/linux/pci.h | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/include/linux/pci.h b/include/linux/pci.h
index 80af26bf858f..038b24ff8a3e 100644
--- a/include/linux/pci.h
+++ b/include/linux/pci.h
@@ -428,7 +428,9 @@ struct pci_dev {
 	unsigned int	is_probed:1;		/* Device probing in progress */
 	unsigned int	link_active_reporting:1;/* Device capable of reporting link active */
 	unsigned int	no_vf_scan:1;		/* Don't scan for VFs after IOV enablement */
+#ifndef __GENKSYMS__	/* BIT 5 in the second 'unsigned int' of the bitfield, so this is safe */
 	unsigned int	no_command_memory:1;	/* No PCI_COMMAND_MEMORY */
+#endif
 	pci_dev_flags_t dev_flags;
 	atomic_t	enable_cnt;	/* pci_enable_device has been called */
 
-- 
2.16.3

