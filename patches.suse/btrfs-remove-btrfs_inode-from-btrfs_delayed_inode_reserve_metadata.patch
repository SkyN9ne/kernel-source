From: Nikolay Borisov <nborisov@suse.com>
Date: Tue, 16 Feb 2021 17:37:13 +0200
Subject: btrfs: Remove btrfs_inode from btrfs_delayed_inode_reserve_metadata
Patch-mainline: Submitted, 23.02.2021 - btrfs mailing list
References: bsc#1182047

It's only used for tracepoint to obtain the ino, but we already have
the ino from btrfs_delayed_node::inode_id.

Acked-by: Nikolay Borisov <nborisov@suse.com>
---
 fs/btrfs/delayed-inode.c |    8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

--- a/fs/btrfs/delayed-inode.c
+++ b/fs/btrfs/delayed-inode.c
@@ -587,7 +587,6 @@ static void btrfs_delayed_item_release_m
 static int btrfs_delayed_inode_reserve_metadata(
 					struct btrfs_trans_handle *trans,
 					struct btrfs_root *root,
-					struct btrfs_inode *inode,
 					struct btrfs_delayed_node *node)
 {
 	struct btrfs_fs_info *fs_info = root->fs_info;
@@ -632,7 +631,7 @@ static int btrfs_delayed_inode_reserve_m
 			node->bytes_reserved = num_bytes;
 			trace_btrfs_space_reservation(fs_info,
 						      "delayed_inode",
-						      btrfs_ino(inode),
+						      node->inode_id,
 						      num_bytes, 1);
 		} else {
 			btrfs_qgroup_free_meta_prealloc(root, num_bytes);
@@ -643,7 +642,7 @@ static int btrfs_delayed_inode_reserve_m
 	ret = btrfs_block_rsv_migrate(src_rsv, dst_rsv, num_bytes, 1);
 	if (!ret) {
 		trace_btrfs_space_reservation(fs_info, "delayed_inode",
-					      btrfs_ino(inode), num_bytes, 1);
+					      node->inode_id, num_bytes, 1);
 		node->bytes_reserved = num_bytes;
 	}
 
@@ -1812,8 +1811,7 @@ int btrfs_delayed_update_inode(struct bt
 		goto release_node;
 	}
 
-	ret = btrfs_delayed_inode_reserve_metadata(trans, root, BTRFS_I(inode),
-						   delayed_node);
+	ret = btrfs_delayed_inode_reserve_metadata(trans, root, delayed_node);
 	if (ret)
 		goto release_node;
 
